var d=Object.defineProperty;var w=(n,e,t)=>e in n?d(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var r=(n,e,t)=>w(n,typeof e!="symbol"?e+"":e,t);import{O as u,C as f,$ as i,f as a,o as c,c as b,n as p,g as x,T as k,b as h}from"./liko.es-Db3MpUbX.js";import"./index-CceWuvSs.js";async function T(){const n=new u;await n.init({width:800,height:600,bgColor:3355443,physics:{enabled:!0,gravity:{x:0,y:40}}});const e=new f({width:1600,height:600,parent:n.stage});new i({url:"assets/background.png",scale:{x:2.2,y:2.2},repeat:!0,width:750,height:256,parent:e});const t=new i({url:"assets/ground.png",repeat:!0,width:1600,height:64,position:{x:0,y:536},parent:e,scripts:[new a({label:"ground",rigidType:"static"})]});new i({url:"assets/block_blue.png",position:{x:0,y:450},parent:e,width:64,height:64,scripts:[new a({label:"block",rigidType:"static"})]});const s=new i({url:"assets/sign_exit.png",position:{x:350,y:472},parent:e,onClick:()=>{if(e.camera.followEnabled){const l=g.localToWorld({x:0,y:0});e.camera.followEnabled=!1,e.camera.lookAt(l.x,l.y),setTimeout(()=>{e.camera.followEnabled=!0},1e3)}}});new c({text:"点我查看目标",textColor:"red",position:{x:32,y:-10},anchor:{x:.5,y:.5},parent:s}),new i({url:"assets/block_coin.png",position:{x:500,y:400},parent:e,width:64,height:64,scripts:[new a({label:"block",rigidType:"static"})]}),new i({url:"assets/coin_gold.png",position:{x:514,y:350},parent:e,width:38,height:40,scripts:[new a({label:"icon",rigidType:"static",shapes:[{shapeType:"circle",radius:20,offset:{x:0,y:0},isSensor:!0}]})]}),new i({url:"assets/block_coin.png",position:{x:650,y:300},parent:e,width:64,height:64,scripts:[new a({label:"block",rigidType:"static"})]}),new i({url:"assets/coin_gold.png",position:{x:664,y:250},parent:e,width:38,height:40,scripts:[new a({label:"icon",rigidType:"static",shapes:[{shapeType:"circle",radius:20,offset:{x:0,y:0},isSensor:!0}]})]});const o=new i({url:"assets/block_spikes.png",position:{x:900,y:500},parent:e,width:64,height:64,anchor:{x:.5,y:.5},scripts:[new a({label:"spikes",rigidType:"static"})]});b.to({target:o,props:{scale:{x:.9,y:.9}},duration:.5,repeat:0,yoyo:!0}).play(),new i({url:"assets/coin_gold.png",position:{x:1e3,y:400},parent:e,width:38,height:40,scripts:[new a({label:"icon",rigidType:"static",shapes:[{shapeType:"circle",radius:20,offset:{x:0,y:0},isSensor:!0}]})]}),new i({url:"assets/coin_gold.png",position:{x:1200,y:450},parent:e,width:38,height:40,scripts:[new a({label:"icon",rigidType:"static",shapes:[{shapeType:"circle",radius:20,offset:{x:0,y:0},isSensor:!0}]})]});const g=new i({url:"assets/flag_green.png",position:{x:1500,y:472},parent:e,width:64,height:64,scripts:[new a({label:"flag",rigidType:"static"})]});new p({url:"assets/sheet/fliggy.atlas",parent:e,position:{x:150,y:528},anchor:{x:.5,y:1},frameRate:20}).play();const y=new p({url:"assets/boy/idle.atlas",parent:e,position:{x:264,y:528},anchor:{x:.5,y:1},frameRate:10,width:128,height:128,scripts:[new a({rigidType:"dynamic",shapes:[{shapeType:"box",width:40,height:78,offset:{x:44,y:50},friction:0}]}),new m]}).play();e.camera.worldBounds=new x(0,0,t.width,t.height),e.camera.followTarget(y,{followX:!0,followY:!1})}T();class m extends k{constructor(){super(...arguments);r(this,"_jumping",!1);r(this,"_dead",!1)}onKeyDown(t){if(!this._dead)if(t.key==="w"&&!this._jumping){this._jumping=!0;const s=this.target.findScript({Class:a});s==null||s.applyLinearImpulse({x:0,y:-20}),this.target.url="assets/boy/jump.atlas"}else t.key==="j"&&(this.target.url="assets/boy/attack3.atlas",this.target.once(h.ended,()=>{this.target.url="assets/boy/idle.atlas"}))}onUpdate(){var o;if(this._dead)return;const t=(o=this.target)==null?void 0:o.stage,s=this.target.findScript({Class:a});t!=null&&t.keyboard.hasKeydown("a")?(this.target.scale.x=-1,s==null||s.setLinearVelocity(-6),this.target.url="assets/boy/run.atlas"):t!=null&&t.keyboard.hasKeydown("d")?(this.target.scale.x=1,s==null||s.setLinearVelocity(6),this.target.url="assets/boy/run.atlas"):s==null||s.setLinearVelocity(0)}onCollisionStart(t){this._dead||(t.other.label==="ground"||t.other.label==="block"?(this._jumping=!1,this.target.url="assets/boy/idle.atlas"):t.other.label==="icon"?t.other.target.destroy():t.other.label==="spikes"&&(this._dead=!0,this.target.url="assets/boy/dead.atlas",this.target.on(h.ended,()=>{this.target.stop(),this.showRestartButton()}),console.log("game over")))}showRestartButton(){var t;new c({text:`游戏结束

按 R 键重新开始`,textColor:"red",fontSize:36,position:{x:400,y:300},anchor:{x:.5,y:.5},parent:this.target.stage}),(t=this.target.stage)==null||t.on("keydown",s=>{(s.key==="r"||s.key==="R")&&window.location.reload()})}}
