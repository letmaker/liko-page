var E=Object.defineProperty;var A=(r,o,e)=>o in r?E(r,o,{enumerable:!0,configurable:!0,writable:!0,value:e}):r[o]=e;var t=(r,o,e)=>A(r,typeof o!="symbol"?o+"":o,e);import{d as c,t as h,Z as O,D as d,_ as I,$ as k,y as D,x as p}from"./liko.es-remNCA1z.js";import"./index-CumCSj91.js";const u="1",b="Scene",S={label:"scene1",width:480,height:700,description:"飞机射击游戏第一关"},f=[{id:"11",type:"Script",description:"场景管理脚本，实现游戏逻辑管理",props:{script:"Scene1",label:"Scene1"}}],x=[{id:"2",type:"Sprite",description:"游戏背景图片，作为所有游戏元素的容器",props:{label:"bg",url:"game2/背景.png",pos:{x:0,y:0},width:480,height:700},children:[{id:"3",type:"Sprite",description:"玩家控制的主角飞机",props:{label:"hero",url:"game2/主角1.png",pos:{x:240,y:500},width:102,height:126,anchor:{x:.5,y:.5}},scripts:[{id:"31",type:"Script",description:"主角飞机控制脚本，处理移动、射击和生命值",props:{script:"Hero",label:"Hero",hp:1,fireRate:3}}]},{id:"100",type:"Sprite",description:"主角飞机发射的子弹模板",props:{label:"主角子弹",url:"game2/主角子弹.png",pos:{x:200,y:600},width:10,height:20,editorOnly:!0},scripts:[{id:"110",type:"Script",description:"主角子弹行为脚本，控制子弹移动和碰撞检测",props:{script:"HeroBullet",label:"HeroBullet"}}]},{id:"200",type:"Sprite",description:"小型敌机，移动速度快但生命值低",props:{label:"Enemy1",url:"game2/敌人1.png",pos:{x:50,y:100},width:57,height:43,editorOnly:!0},scripts:[{id:"210",type:"Script",description:"小型敌机AI脚本，控制移动和攻击模式",props:{script:"Enemy1",label:"Enemy1"}}]},{id:"200",type:"Sprite",description:"中型敌机，具有中等生命值和攻击力",props:{label:"Enemy2",url:"game2/敌人2.png",pos:{x:150,y:100},width:69,height:99,editorOnly:!0},scripts:[{id:"210",type:"Script",description:"中型敌机AI脚本，控制移动轨迹和射击频率",props:{script:"Enemy2",label:"Enemy2"}}]},{id:"300",type:"Sprite",description:"关卡Boss，拥有高生命值和复杂的攻击模式",props:{label:"Boss1",url:"game2/boss1.png",pos:{x:300,y:100},width:169,height:258,editorOnly:!0},scripts:[{id:"210",type:"Script",description:"Boss行为脚本，实现多阶段战斗和特殊攻击模式",props:{script:"Boss1",label:"Boss1"}}]},{id:"400",type:"Sprite",description:"敌方单位发射的子弹模板",props:{label:"EnemyBullet",url:"game2/敌人子弹.png",pos:{x:100,y:100},width:10,height:20,editorOnly:!0},scripts:[{id:"410",type:"Script",description:"敌方子弹行为脚本，控制子弹移动和伤害判定",props:{script:"EnemyBullet",label:"EnemyBullet"}}]}]},{id:"999",type:"Text",description:"显示积分",props:{label:"score",text:"Score: 0",textColor:"#ff0000",pos:{x:10,y:10},fontSize:20}}],M={id:u,type:b,props:S,scripts:f,children:x},B=Object.freeze(Object.defineProperty({__proto__:null,children:x,default:M,id:u,props:S,scripts:f,type:b},Symbol.toStringTag,{value:"Module"}));class g extends c{constructor(){super(...arguments);t(this,"linearVelocity",{x:0,y:0})}onAwake(){const e=new h({rigidType:"kinematic",linearVelocity:this.linearVelocity,category:"enemyBullet",categoryAccepted:["hero"]});this.target.addScript(e)}onCollisionStart(){debugger;this.target.destroy()}}class H extends c{constructor(){super(...arguments);t(this,"hp",20);t(this,"bulletTimer",0);t(this,"bulletFireRate",1);t(this,"bulletCount",6);t(this,"bulletSpeed",2)}onAwake(){O.from({target:this.target,duration:1,props:{alpha:0,pos:{x:"+0",y:-100}}}).onAllComplete(()=>{const e=new h({rigidType:"dynamic",category:"enemy",categoryAccepted:["heroBullet"],gravityScale:0,isSensor:!0});this.target.addScript(e)}).play()}onUpdate(e){this.bulletTimer+=e,this.bulletTimer>=1/this.bulletFireRate&&(this._fireBullets(),this.bulletTimer=0)}_fireBullets(){var e,i;for(let s=0;s<this.bulletCount;s++){const l=s/this.bulletCount*Math.PI*2,a=Math.cos(l)*this.bulletSpeed,y=Math.sin(l)*this.bulletSpeed,n=(e=this.scene)==null?void 0:e.cloneNode({label:"EnemyBullet"});if(n){n.rotation=l+Math.PI/2,n.pos.set(this.target.pos.x+this.target.width/2,this.target.pos.y+this.target.height/2),(i=this.scene)==null||i.addChild(n);const m=n.findScript({Class:g});m&&(m.linearVelocity={x:a,y})}}}onCollisionStart(){this.hp--,this.hp<=0&&(this.signal("bossDead"),this.signal("scoreChanged",{score:10}),this.target.destroy(),d.play("game2/声音/爆炸.mp3"))}}class P extends c{constructor(){super(...arguments);t(this,"hp",1);t(this,"speed",1)}onAwake(){const e=new h({rigidType:"dynamic",linearVelocity:{x:0,y:this.speed},category:"enemy",categoryAccepted:["heroBullet"],gravityScale:0,isSensor:!0});this.target.addScript(e)}onCollisionStart(){this.hp--,this.hp<=0&&(this.signal("scoreChanged",{score:1}),this.target.destroy(),d.play("game2/声音/死亡1.mp3"))}}class V extends c{constructor(){super(...arguments);t(this,"hp",2);t(this,"speed",1);t(this,"bulletTimer",0);t(this,"bulletFireRate",.5);t(this,"bulletSpeed",2)}onAwake(){const e=new h({rigidType:"dynamic",linearVelocity:{x:0,y:this.speed},category:"enemy",categoryAccepted:["heroBullet"],gravityScale:0,isSensor:!0});this.target.addScript(e)}onUpdate(e){this.bulletTimer+=e,this.bulletTimer>=1/this.bulletFireRate&&(this._fireBullets(),this.bulletTimer=0)}_fireBullets(){var i,s;const e=(i=this.scene)==null?void 0:i.cloneNode({label:"EnemyBullet"});if(e){e.pos.set(this.target.pos.x+this.target.width/2,this.target.pos.y+this.target.height),(s=this.scene)==null||s.addChild(e);const l=e.findScript({Class:g});l&&(l.linearVelocity={x:0,y:this.bulletSpeed})}}onCollisionStart(){this.hp--,this.hp<=0&&(this.signal("scoreChanged",{score:2}),this.target.destroy(),d.play("game2/声音/死亡2.mp3"))}}const C="1",T="Scene",w={label:"gameOverUI",width:480,height:700,description:"游戏结束的UI场景"},_=[{id:"11",type:"Script",description:"",props:{script:"GameOver",label:"GameOver"}}],v=[{id:"2",type:"Text",description:"",props:{label:"score",text:"积分",fontSize:30,textColor:"#ff0000",pos:{x:240,y:200},anchor:{x:.5,y:.5},width:100,height:30}},{id:"3",type:"Sprite",description:"",props:{label:"over",url:"game2/游戏结束.png",pos:{x:240,y:400},anchor:{x:.5,y:.5},width:300,height:41}},{id:"4",type:"Sprite",description:"",props:{label:"restart",url:"game2/重新开始.png",pos:{x:240,y:500},anchor:{x:.5,y:.5},width:300,height:41}}],$={id:C,type:T,props:w,scripts:_,children:v},R=Object.freeze(Object.defineProperty({__proto__:null,children:v,default:$,id:C,props:w,scripts:_,type:T},Symbol.toStringTag,{value:"Module"}));class U extends c{constructor(){super(...arguments);t(this,"_scoreText")}onAwake(){var s,l;this._scoreText=this.target.findChild({label:"score",deep:!0});const e=(s=this.stage)==null?void 0:s.store.get("score");(l=this._scoreText)==null||l.setText(`Score: ${e}`);const i=this.target.findChild({label:"restart",deep:!0});i==null||i.on(I.click,()=>{var a,y,n;(a=this.stage)==null||a.timer.resume(),(y=this.stage)==null||y.store.set("score",0),(n=this.stage)==null||n.createScene(B,{destroyOther:!0})}),setTimeout(()=>{var a;(a=this.stage)==null||a.timer.pause()},100)}}class N extends c{constructor(){super(...arguments);t(this,"_selected",!1);t(this,"_fireTime",0);t(this,"_rigidBody");t(this,"bulletId","100");t(this,"fireRate",3);t(this,"hp",1)}onAwake(){this._rigidBody=new h({rigidType:"dynamic",gravityScale:0,isSensor:!0,category:"hero",categoryAccepted:["enemy","enemyBullet"]}),this.target.addScript(this._rigidBody)}onUpdate(e){var i,s;if(this._fireTime+=e,this._fireTime>1/this.fireRate){this._fireTime=0;const l=(i=this.scene)==null?void 0:i.cloneNode({id:this.bulletId});l&&(l.pos.set(this.target.pos.x,this.target.pos.y-80),(s=this.scene)==null||s.addChild(l))}}onPointerDown(){this._selected=!0}onStagePointerMove(e){var i;this._selected&&((i=this._rigidBody)==null||i.setPosition(e.pointer.x-this.target.width/2,e.pointer.y-this.target.height/2))}onStagePointerUp(){this._selected=!1}onCollisionStart(){this.hp--,this.hp<=0&&(this.signal("heroDead"),this.target.destroy(),d.play("game2/声音/失败.mp3"))}}class j extends c{onAwake(){const o=new h({rigidType:"kinematic",linearVelocity:{x:0,y:-3},category:"heroBullet",categoryAccepted:["enemy"]});this.target.addScript(o),d.play("game2/声音/子弹.mp3")}onCollisionStart(){this.target.destroy()}}class z extends c{constructor(){super(...arguments);t(this,"enemyCreateInterval",2);t(this,"enemyCreateTime",0);t(this,"bossCreateInterval",15);t(this,"bossCreateTime",0);t(this,"bossState",!1);t(this,"_scoreText");t(this,"_score",0)}onAwake(){this._scoreText=this.target.findChild({label:"score",deep:!0})}onUpdate(e){this.bossState!==!0&&(this.bossCreateTime+=e,this.bossCreateTime>this.bossCreateInterval&&(this.bossState=!0,this.bossCreateTime=0,this.createBoss()),this.enemyCreateTime+=e,this.enemyCreateTime>this.enemyCreateInterval&&(this.enemyCreateTime=0,this.createEnemy()))}createEnemy(){var i,s;const e=(i=this.scene)==null?void 0:i.cloneNode({label:Math.random()>.35?"Enemy1":"Enemy2"});e&&(e.pos.set(Math.random()*(this.stage.width-e.width),-e.height),(s=this.scene)==null||s.addChild(e))}createBoss(){var i,s;const e=(i=this.scene)==null?void 0:i.cloneNode({label:"Boss1"});e&&(e.pos.set((this.stage.width-e.width)/2,50),(s=this.scene)==null||s.addChild(e))}onSignal(e,i){var s,l,a;e==="bossDead"?this.bossState=!1:e==="heroDead"?((s=this.stage)==null||s.store.set("score",this._score),(l=this.stage)==null||l.createScene(R)):e==="scoreChanged"&&(this._score=this._score+((i==null?void 0:i.score)??0),(a=this._scoreText)==null||a.setText(`Score: ${this._score}`))}}async function F(){const r=new k;await r.init({width:480,height:700,physics:{enabled:!0,boundaryArea:new D(0,0,480,700).pad(500),debug:!0}}),p("Enemy1",P),p("Enemy2",V),p("Boss1",H),p("EnemyBullet",g),p("Hero",N),p("HeroBullet",j),p("Scene1",z),p("GameOver",U),r.stage.createScene(B)}F();
